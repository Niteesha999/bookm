import jaydebeapi

# Path to the Netezza JDBC driver JAR file
jdbc_driver_path = '/path/to/nzjdbc.jar'  # Replace with your actual path to nzjdbc.jar

# Database connection details
url = 'jdbc:netezza://your_server_url:5480/your_database'  # Replace with your server URL and database name
driver_class = 'org.netezza.Driver'

# Read credentials from a text file
def read_credentials(file_path):
    credentials = {}
    with open(file_path, 'r') as file:
        for line in file:
            key, value = line.strip().split('=')
            credentials[key] = value
    return credentials

# Read username and password
credentials_file = 'credentials.txt'
credentials = read_credentials(credentials_file)
username = credentials.get('username')
password = credentials.get('password')

# Test connection to Netezza
try:
    # Establish a connection using the JDBC driver
    conn = jaydebeapi.connect(driver_class, url, [username, password], jdbc_driver_path)
    print("Connection to Netezza database was successful.")
    conn.close()
except Exception as e:
    print(f"Failed to connect to the Netezza database: {e}")
