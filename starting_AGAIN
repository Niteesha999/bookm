import pyodbc

# Function to read credentials from a text file
def read_credentials(file_path):
    credentials = {}
    with open(file_path, 'r') as file:
        for line in file:
            key, value = line.strip().split('=')
            credentials[key] = value
    return credentials

# Connection parameters
alias = 'your_alias'  # Replace with your actual alias
driver = '{NetezzaSQL}'  # Netezza driver name
url = 'your_server_url'  # Replace with your actual server URL
# Read credentials from the text file
credentials_file = 'credentials.txt'
credentials = read_credentials(credentials_file)

# Extract username and password from the credentials dictionary
username = credentials.get('username')
password = credentials.get('password')

# Connection string using the provided parameters
conn_str = (
    f"DRIVER={driver};"
    f"SERVER={url};"
    f"DATABASE={alias};"
    f"UID={username};"
    f"PWD={password};"
)

# Test the connection
try:
    conn = pyodbc.connect(conn_str)
    print("Connection to Netezza database was successful.")
    conn.close()
except Exception as e:
    print(f"Failed to connect to the Netezza database: {e}")
